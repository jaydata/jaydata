<!DOCTYPE html>
<html>
<head>
    <title>JayData unit tests</title>
    <meta charset=utf-8 />

    <link href="http://cdn.kendostatic.com/2012.3.1315/styles/kendo.common.min.css" rel="stylesheet" type="text/css" />
<!--    <link href="http://cdn.kendostatic.com/2012.3.1315/styles/kendo.rtl.min.css" rel="stylesheet" type="text/css" />-->
    <link href="http://cdn.kendostatic.com/2012.3.1315/styles/kendo.default.min.css" rel="stylesheet" type="text/css" />
    <link href="http://cdn.kendostatic.com/2012.3.1315/styles/kendo.dataviz.min.css" rel="stylesheet" type="text/css" />
    <link href="http://cdn.kendostatic.com/2012.3.1315/styles/kendo.dataviz.default.min.css" rel="stylesheet" type="text/css" />
<!--    <link href="http://cdn.kendostatic.com/2012.3.1315/styles/kendo.mobile.all.min.css" rel="stylesheet" type="text/css" />-->
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="Scripts/modernizr-2.5.3.js"></script>
    <!--<link href="Content/Site.css" rel="stylesheet" />-->
    <script src="http://cdn.kendostatic.com/2012.3.1315/js/kendo.all.min.js"></script>
<!--    <script type="text/javascript" src="Scripts/jquery.validate.js"></script>-->
<!--    <script src="3rdparty/kendo/src/js/kendo.core.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.data.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.binder.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.grid.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.editable.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.sortable.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.validator.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.calendar.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.timepicker.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.datetimepicker.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.datepicker.js"></script>
    <script src="3rdparty/kendo/src/js/kendo.popup.js"></script>-->
    <!--<script src="3rdparty/kendo/js/kendo.web.min.js"></script>-->
    <script src="Scripts/datajs-1.1.0.js"></script>

    <!--************************************************************************************-->
    <script type="text/javascript" src="TypeSystem/initializeJayDataClient.js"></script>
    <script type="text/javascript" src="TypeSystem/initializeJayData.js"></script>    
    <script type="text/javascript" src="TypeSystem/utils.js"></script>
    <script type="text/javascript" src="TypeSystem/PreHtml5Compatible.js"></script>
    <script type="text/javascript" src="TypeSystem/JayLint.js"></script>
    <script type="text/javascript" src="TypeSystem/TypeSystem.js"></script>
    <script type="text/javascript" src="TypeSystem/Trace/Trace.js"></script>
    <script type="text/javascript" src="TypeSystem/Trace/Logger.js"></script>
    <script type="text/javascript" src="TypeSystem/Types/SimpleBase.js"></script>
    <script type="text/javascript" src="TypeSystem/Types/Geospatial.js"></script>
    <script type="text/javascript" src="TypeSystem/Types/Geography.js"></script>
    <script type="text/javascript" src="TypeSystem/Types/Geometry.js"></script>
    <script type="text/javascript" src="TypeSystem/Types/Guid.js"></script>
    <script type="text/javascript" src="TypeSystem/Types/EdmTypes.js"></script>
    <script type="text/javascript" src="TypeSystem/Extensions.js"></script>
    <!--*******************************Expressions****************************************-->
    <script type="text/javascript" src="Types/Expressions/ASTParser.js"></script>
    <script type="text/javascript" src="Types/Expressions/ExpressionNode2.js"></script>
    <script src="Types/DbClient/Transaction.js"></script>
    <script src="Types/StorageProviders/SqLite/SqlTransaction.js"></script>
    <script type="text/javascript" src="Types/Expressions/ArrayLiteralExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/CallExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/CodeParser.js"></script>
    <script type="text/javascript" src="Types/Expressions/ConstantExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/FunctionExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/ObjectFieldExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/ObjectLiteralExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/PagingExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/ParameterExpression.js"> </script>
    <script type="text/javascript" src="Types/Expressions/PropertyExpression.js" ></script>   
    <script type="text/javascript" src="Types/Expressions/SimpleBinaryExpression.js" ></script>
    <script type="text/javascript" src="Types/Expressions/ThisExpression.js" ></script>    
    
    <script type="text/javascript" src="Types/Expressions/Visitors/ExpressionVisitor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/ParameterProcessor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/GlobalContextProcessor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/LocalContextProcessor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/LambdaParameterProcessor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/ParameterResolverVisitor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/LogicalSchemaBinderVisitor.js"></script>

    <script type="text/javascript" src="Types/Expressions/Visitors/ExpTreeVisitor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/SetExecutableVisitor.js"></script>
    <script type="text/javascript" src="Types/Expressions/Visitors/ExecutorVisitor.js"></script>
    
    <script type="text/javascript" src="Types/Expressions/ExpressionBuilder.js"></script>
    
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/AssociationInfoExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/CodeExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/CodeToEntityConverter.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/ComplexTypeExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/EntityContextExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/EntityExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/EntityExpressionVisitor.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/EntityFieldExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/EntityFieldOperationExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/EntitySetExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/ServiceOperationExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/FrameOperationExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/FilterExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/IncludeExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/MemberInfoExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/OrderExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/ParametricQueryExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/ProjectionExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/QueryExpressionCreator.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/QueryParameterExpression.js"></script>
    <script type="text/javascript" src="Types/Expressions/EntityExpressions/RepresentationExpression.js"></script>

    <script type="text/javascript" src="Types/Expressions/ContinuationExpressionBuilder.js"></script>
    
    <!--******************************* Validation ****************************************-->  
    <script type="text/javascript" src="Types/Validation/EntityValidationBase.js"></script>
    <script type="text/javascript" src="Types/Validation/EntityValidation.js"></script>
    <!--******************************* Notification ****************************************-->  
    <script type="text/javascript" src="Types/Notifications/ChangeDistributorBase.js"></script>
    <script type="text/javascript" src="Types/Notifications/ChangeCollectorBase.js"></script>
    <script type="text/javascript" src="Types/Notifications/ChangeDistributor.js"></script>
    <script type="text/javascript" src="Types/Notifications/ChangeCollector.js"></script>
    
    <!--******************************* Types ****************************************--> 
    <script type="text/javascript" src="Types/Access.js"></script>
    <script type="text/javascript" src="Types/Promise.js"></script>
    <script type="text/javascript" src="Types/Entity.js"></script>
    <script type="text/javascript" src="Types/EntityContext.js"></script>
    <script type="text/javascript" src="Types/QueryProvider.js"></script>
    <script type="text/javascript" src="Types/ModelBinder.js"></script>
    <script type="text/javascript" src="Types/QueryBuilder.js"></script>
    <script type="text/javascript" src="Types/Query.js"></script>
    <script type="text/javascript" src="Types/Queryable.js"></script>
    <script type="text/javascript" src="Types/EntitySet.js"></script>

    <script type="text/javascript" src="Types/AuthEntityContext.js"></script>
    <script type="text/javascript" src="Types/EntityState.js"></script>
    <script type="text/javascript" src="Types/EntityStateManager.js"></script>
    <script type="text/javascript" src="Types/ItemStore.js"></script>
    <script type="text/javascript" src="Types/Exception.js"></script>
    <script type="text/javascript" src="Types/StorageProviderLoader.js"></script>
    <script type="text/javascript" src="Types/StorageProviderBase.js"></script>
    <script type="text/javascript" src="Types/ServiceOperation.js"></script>

    <script type="text/javascript" src="Types/EntityWrapper.js"></script>
    <script type="text/javascript" src="JaySvcUtil/JaySvcUtil.js"></script>
    <script type="text/javascript" src="Types/JayStorm.js"></script>

    <!--******************************* Ajax*********************************************-->    
    <script type="text/javascript" src="Types/Ajax/jQueryAjaxWrapper.js"></script>
    <script type="text/javascript" src="Types/Ajax/WinJSAjaxWrapper.js"></script>
    <script type="text/javascript" src="Types/Ajax/ExtJSAjaxWrapper.js"></script>        
    <script type="text/javascript" src="Types/Ajax/AjaxStub.js"></script>

    <!--******************************* DbClient ****************************************-->
    <script type="text/javascript" src="Types/DbClient/DbCommand.js"></script>
    <script type="text/javascript" src="Types/DbClient/DbConnection.js"></script>
    <script type="text/javascript" src="Types/DbClient/OpenDatabaseClient/OpenDbCommand.js"></script>
    <script type="text/javascript" src="Types/DbClient/OpenDatabaseClient/OpenDbConnection.js"></script>
    <script type="text/javascript" src="Types/DbClient/JayStorageClient/JayStorageCommand.js"></script>
    <script type="text/javascript" src="Types/DbClient/JayStorageClient/JayStorageConnection.js"></script>
    <script type="text/javascript" src="Types/DbClient/SqLiteNjClient/SqLiteNjCommand.js"></script>
    <script type="text/javascript" src="Types/DbClient/SqLiteNjClient/SqLiteNjConnection.js"></script>

    <script type="text/javascript" src="Types/StorageProviders/modelBinderConfigCompiler.js"></script>
    <!--******************************* StorageProvider - sqLite ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/SqLite/SqLiteStorageProvider.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/SqLiteCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/SqlPagingCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/SqlOrderCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/SqlProjectionCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/ExpressionMonitor.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/SqlFilterCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/SqLite/ModelBinder/sqLite_ModelBinderCompiler.js"></script>
    <!--******************************* StorageProvider - oData ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/oData/oDataProvider.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/oData/oDataCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/oData/oDataWhereCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/oData/oDataOrderCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/oData/oDataPagingCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/oData/oDataProjectionCompiler.js"></script>
    <!--******************************* StorageProvider - IndexDb ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/IndexedDB/IndexedDBStorageProvider.js"></script>
    
    <!--******************************* Authentication???? ****************************************-->
    <script type="text/javascript" src="Types/Authentication/AuthenticationBase.js"></script>
    <script type="text/javascript" src="Types/Authentication/Anonymous.js"></script>
    <script type="text/javascript" src="Types/Authentication/FacebookAuth.js"></script>

    <!--******************************* StorageProvider - Facebook ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/Facebook/FacebookProvider.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/Facebook/FacebookCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/Facebook/EntitySets/FQL/user.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/Facebook/EntitySets/FQL/friend.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/Facebook/EntitySets/FQL/page.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/Facebook/EntitySets/FQLContext.js"></script>
    
    <!--******************************* StorageProvider - YQL ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/YQL/YQLProvider.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/YQL/YQLCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/YQL/EntitySets/geo.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/YQL/EntitySets/YQLContext.js"></script>
        
    <!--******************************* StorageProvider - inMemory ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/InMemory/InMemoryProvider.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/InMemory/InMemoryCompiler.js"></script>
    <script type="text/javascript" src="Types/StorageProviders/InMemory/InMemoryFunctionCompiler.js"></script>

    <!--******************************* StorageProvider - webApi ****************************************-->
    <script type="text/javascript" src="Types/StorageProviders/WebApi/WebApiProvider.js"></script>

    <!--******************************* OData Parser ****************************************-->
    <script type="text/javascript" src="oDataParser/RequestExpressionBuilder.js"></script>
    <script type="text/javascript" src="oDataParser/RequestLexer.js"></script>
    <script type="text/javascript" src="oDataParser/RequestParser.js"></script>

    <script type="text/javascript" src="oDataParser/EntityExpressionBuilder.js"></script>
    <script type="text/javascript" src="oDataParser/ODataEntityExpressionBuilder.js"></script>


    <!--******************************* jsExtensions ****************************************-->
    <script type="text/javascript" src="JayDataModules/deferred.js"></script>
    <script type="text/javascript" src="JayDataModules/formBinder.js"></script>
    <script type="text/javascript" src="JayDataModules/template.js"></script>
    <script type="text/javascript" src="JayDataModules/validate.js"></script>
    <script type="text/javascript" src="JayDataModules/knockout.js"></script>
    <script type="text/javascript" src="JayDataModules/kendo.js"></script>
    <script type="text/javascript" src="JayDataModules/inMemory.js"></script>
    <!--************************************************************************************-->
    

    <!--**********************************UNIT TESTS****************************************-->
    <script>
        /*
        Task.setStore('xxxx', { provider: 'oData', oDataServiceHost: 'x', tableName: 'xxx' });
        Task.setStore('xxx3', { provider: 'webApi', dataSource: 'api/todos' });
        Task.setStore('xxx2', { provider: 'webApi', apiUrl: 'api', tableName: 'todos' });
        */
        //var T = $data.define("Task", {
        //    Todo: String,
        //    Completed: Boolean
        //});

        //var contextT = $data.EntityContext.extend("CX", {
        //    Tasks: { type: $data.EntitySet, elementType: T }
        //});

        //var ctx = new contextT({ name: 'local', databaseName: 'xxxx' });

        //$data.define('XXX', {
        //    Id: {
        //        key: true,
        //        type: 'string',
        //        get: function () { return this.F1 + this.F2 },
        //        set: function (value) { }
        //    },
        //    F1: String,
        //    F2: String
        //})
    </script>    
</head>
<body>

    <script type="text/x-kendo-tmpl" id="editTemplate">
        <div class="product-view">
            <dl>
                <dt>Todo</dt>
                <dd>
                    <input type="text" data-bind="value:Todo" name="Todo" required="required" validationMessage="required" />
                    <span data-for="ProductName" class="k-invalid-msg"></span>
                </dd>
                <dt>Completed</dt>
                <dd>
                    <input type="checkbox" data-bind="checked:Done" name="Done" />
                </dd>
                <dt>Id</dt>
                <dd>
                    <input type="text" data-bind="value:Id" name="Id" />
                    <span data-for="ProductName" class="k-invalid-msg"></span>
                </dd>
            </dl>
            <div class="edit-buttons">
                <a class="k-button k-button-icontext k-update-button" href="\\#"><span class="k-icon k-update"></span>Save</a>
                <a class="k-button k-button-icontext k-cancel-button" href="\\#"><span class="k-icon k-cancel"></span>Cancel</a>
            </div>
        </div>
    </script>
    <div id="grid">

    </div>
    <script>
        var apiKey = {
            ownerId: 'a0f577b9-8b98-4685-af6d-98943da6448f',
            appId: '9fe72773-3e38-4c4d-af21-6716ec70876c',
            serviceName: 'mydatabase'
        };
        
        // the credentials used when connecting to the service
        // set <username> and <password> correctly
        // uncomment this section to enable
        /*var credentials = {
            user: '<username>',
            password: '<password>'
        };*/
        
        // initialize the connection to the mydatabase service in the  application
        // credentials are optional, anonymous access used if omitted
        //$data.initService(apiKey).then(function (mydatabase, factory, type) {
        //    $('#grid').kendoGrid({
        //        dataSource: mydatabase.TodoItems.asKendoDataSource({ batch: true }),
        //        editable: 'inline',
        //        pageable: true,
        //        columns: [{ command: ['edit', 'delete'] }].concat(mydatabase.TodoItems.asKendoColumns()),
        //        toolbar: ['create','save']
        //    })
        //});

        $data.define("Todo", {
            Task: String,
            DueDate: Date,
            Completed: Boolean
        })


        //$data.service("/Services/TaskManagerService.svc", function (f, t) {
        //    var db = f();

        //    db.onReady(function() {
        $('#grid').kendoGrid({
            dataSource: Todo.asKendoDataSource(),
            editable: 'inline',
            toolbar: ['create', 'save'],
            sortable: true
        })
        //});

        //$data.service("/Services/emptyNewsReader.svc", function (f, t) {
        //    var db = f();
        //    var listView = $("#listView").kendoListView({
        //        dataSource: db.Articles.asKendoDataSource(),
        //        template: kendo.template('<div>${Title}</div>')
        //    }).data("kendoListView");
        //});


        ////var listView = $("#listView").kendoListView({
        ////    dataSource: ds,
        ////    template: kendo.template('<div>${Id}, ${Todo}</div>'),
        ////    editTemplate: kendo.template($('#editTemplate').html())
        ////}).data("kendoListView");

        ////$(".k-add-button").click(function () {
        ////    alert("!");
        ////    listView.add();
        ////});
        ////$("#pager").kendoPager({
        ////    dataSource: ds
        ////});
    </script>

</body>
</html>
